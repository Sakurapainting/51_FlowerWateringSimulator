C51 COMPILER V9.54   RELAY                                                                 05/25/2025 14:34:34 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE RELAY
OBJECT MODULE PLACED IN .\Objects\relay.obj
COMPILER INVOKED BY: D:\Keil5\C51\BIN\C51.EXE relay.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\relay
                    -.lst) OBJECT(.\Objects\relay.obj)

line level    source

   1          #include "relay.h"
   2          #include "pca.h"  // 添加pca.h以使用BYTE类型定义
   3          
   4          // 继电器控制引脚定义
   5          sbit RELAY_CTRL = P1^1;  // 继电器控制引脚 - 连接继电器的控制端，高电平时继电器闭
             -合
   6          sbit RELAY_NODE1 = P1^0; // 继电器常开节点连接的第一个引脚 - 连接到方波发生器输出
             -，模拟流量计信号输出
   7          sbit RELAY_NODE2 = P3^2; // 继电器常开节点连接的第二个引脚 - 连接到INT0，用于捕获
             -量计脉冲
   8          
   9          // 继电器控制函数实现
  10          void Relay_Init(void) {
  11   1          RELAY_CTRL = 0;      // 初始状态下继电器关闭，即水阀关闭
  12   1          RELAY_NODE1 = 1;     // 将P1.0设为高电平（作为输入时的上拉）
  13   1          RELAY_NODE2 = 1;     // 将P3.2设为高电平（作为输入时的上拉）
  14   1          
  15   1          /* 浇水系统引脚连接说明：
  16   1           * 1. P1.1 (RELAY_CTRL) - 输出：连接继电器控制端，高电平时继电器通电，水阀打
             -
  17   1           * 2. P1.0 (RELAY_NODE1) - 输出：方波发生器输出，模拟流量计信号源
  18   1           * 3. P3.2 (RELAY_NODE2) - 输入：INT0外部中断输入，当继电器闭合时接收P1.0的方波
             -号
  19   1           * 
  20   1           * 工作原理：
  21   1           * - 当P1.1输出高电平，继电器通电，常开触点闭合
  22   1           * - 此时P1.0输出的方波信号会传导到P3.2
  23   1           * - P3.2的INT0中断会捕获这些脉冲并进行计数，实现流量计功能
  24   1           * - 当P1.1输出低电平，继电器断电，常开触点断开，信号传输中断
  25   1           */
  26   1      }
  27          
  28          void Relay_On(void) {
  29   1          RELAY_CTRL = 1;      // 开启继电器
  30   1      }
  31          
  32          void Relay_Off(void) {
  33   1          RELAY_CTRL = 0;      // 关闭继电器
  34   1      }
  35          
  36          BYTE Relay_GetState(void) {
  37   1          return RELAY_CTRL;   // 返回继电器当前状态
  38   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     19    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.

C51 COMPILER V9.54   RELAY                                                                 05/25/2025 14:34:34 PAGE 2   


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
